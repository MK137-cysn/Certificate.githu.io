<!DOCTYPE html>
<html lang="km">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fixed Frame Certificate</title>
    <link href="https://fonts.googleapis.com/css2?family=Siemreap&family=Cinzel:wght@700&family=Playball&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        :root { 
            --gold-color: #d4af37;
            --navy-color: #0c1424;
        }

        body { font-family: 'Siemreap', sans-serif; margin: 0; background: #111; color: #fff; }

        /* Navbar */
        .navbar { 
            background: rgba(0,0,0,0.95); height: 38px; 
            display: flex; align-items: center; justify-content: space-between; 
            padding: 0 12px; position: sticky; top: 0; z-index: 2000;
            border-bottom: 1px solid var(--gold-color);
        }
        .menu-btn { background: var(--gold-color); border: none; padding: 3px 12px; border-radius: 4px; cursor: pointer; color: #000; font-weight: bold; font-size: 10px; }

        /* Ads Telegram */
        #adsPopup { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: flex; align-items: center; justify-content: center; z-index: 3000; backdrop-filter: blur(5px); }
        .ads-content { background: #fff; color: #333; width: 85%; max-width: 350px; padding: 25px; border-radius: 15px; text-align: center; border: 2px solid var(--gold-color); }
        .tg-link { display: block; background: #0088cc; color: white; text-decoration: none; padding: 10px; margin: 8px 0; border-radius: 8px; font-weight: bold; font-size: 13px; }
        .close-ads { background: var(--gold-color); border: none; padding: 10px 30px; border-radius: 50px; font-weight: bold; cursor: pointer; margin-top: 15px; }

        /* Editor Panel */
        .overlay-editor { position: fixed; top: 38px; left: 0; width: 100%; height: 0; background: #fff; z-index: 1500; overflow-y: auto; transition: 0.3s; color: #333; padding: 0 20px; box-sizing: border-box; }
        .overlay-editor.active { height: calc(100% - 38px); padding-top: 20px; }
        .input-box { margin-bottom: 12px; }
        .input-box label { font-size: 11px; font-weight: bold; display: block; margin-bottom: 4px; }
        .input-box input, .input-box textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px; font-family: 'Siemreap'; box-sizing: border-box; }
        .btn-action { background: var(--navy-color); color: gold; width: 100%; padding: 14px; border: 1px solid gold; border-radius: 8px; font-weight: bold; cursor: pointer; margin-bottom: 10px; }

        /* Certificate Rendering Section */
        .preview-area { display: flex; flex-direction: column; align-items: center; padding: 20px; gap: 40px; }
        .cert-wrapper { transform: scale(0.23); margin: -300px 0; }
        @media (min-width: 800px) { .cert-wrapper { transform: scale(0.55); margin: -180px 0; } }

        /* á€á¶ášášá…á“á¶áŸáŸŠá»á˜ááŸ’á˜á¸áŠá¾á˜áŸ’á”á¸á€á»áŸ†á±áŸ’á™á”á¶ááŸ‹á–áŸá› Download */
        .cert-paper { 
            width: 1123px; height: 794px; 
            background: var(--navy-color); 
            padding: 20px; /* áŸáŸŠá»á˜á€áŸ’ášáŸ…á–ááŸŒ Navy */
            box-sizing: border-box; 
            display: flex; align-items: center; justify-content: center;
        }

        .gold-frame-outer {
            width: 100%; height: 100%;
            background: var(--gold-color);
            padding: 5px; /* á€á˜áŸ’ášá¶áŸáŸ‹ááŸ’áŸáŸ‚á˜á¶áŸá‘á¸áŸ¡ */
            box-sizing: border-box;
            display: flex; align-items: center; justify-content: center;
        }

        .gold-frame-inner {
            width: 100%; height: 100%;
            background: var(--navy-color);
            padding: 8px; /* á‚á˜áŸ’á›á¶áášáœá¶á„ááŸ’áŸáŸ‚á˜á¶áŸá‘á¶áŸ†á„á–á¸áš */
            box-sizing: border-box;
            display: flex; align-items: center; justify-content: center;
        }

        .cert-content { 
            width: 100%; height: 100%; 
            background: #fffdf5; /* á•áŸ’á‘áŸƒá€áŸ’á“á»á„áœá·á‰áŸ’á‰á¶á”á“á”áŸááŸ’áš */
            border: 3px solid var(--gold-color); /* ááŸ’áŸáŸ‚á˜á¶áŸá‘á¸áŸ¢ */
            display: flex; flex-direction: column; align-items: center; justify-content: space-around; 
            padding: 50px 80px; box-sizing: border-box; position: relative;
        }
        
        /* Typography */
        .header-title { font-family: 'Cinzel'; font-size: 85px; color: var(--navy-color); margin: 0; line-height: 1; }
        .sub-title { color: var(--gold-color); font-weight: bold; letter-spacing: 10px; font-size: 22px; font-family: 'Cinzel'; }
        .student-name { font-family: 'Playball', cursive; color: var(--navy-color); border-bottom: 4px double var(--gold-color); padding: 0 60px; font-size: 80px; margin: 20px 0; }
        .desc { font-size: 22px; color: #333; max-width: 850px; text-align: center; line-height: 1.6; font-family: 'Siemreap'; }

        .footer { width: 100%; display: flex; justify-content: space-between; align-items: flex-end; }
        .sign-block { text-align: center; width: 300px; }
        .sign-name { font-weight: bold; font-size: 24px; color: var(--navy-color); }
        .line { border-top: 2px solid var(--navy-color); width: 100%; margin-top: 8px; }
        .sign-label { font-size: 14px; color: #888; margin-top: 5px; letter-spacing: 1px; }

        .seal { position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%); width: 110px; }
    </style>
</head>
<body>

    <div id="adsPopup">
        <div class="ads-content">
            <h2 style="margin:0 0 10px 0;">áŸá¼á˜á…á¼á›ášá½á˜á‡á¶á˜á½á™á™á¾á„</h2>
            <a href="https://t.me/Lesson_questions12" class="tg-link" target="_blank">ğŸ“¢ Lesson Questions</a>
            <a href="https://t.me/CHANNEL_QUIZ11" class="tg-link" target="_blank">ğŸ§  Channel Quiz</a>
            <a href="https://t.me/I_AM_RA2" class="tg-link" target="_blank">ğŸ‘¤ I AM RA2</a>
            <button class="close-ads" onclick="closeAds()">á™á›áŸ‹á–áŸ’ášá˜ á“á·á„á…á¼á›á”áŸ’ášá¾</button>
        </div>
    </div>

    <div class="navbar">
        <button class="menu-btn" onclick="toggleMenu()">â˜° á€áŸ‚á¢ááŸ’áá”á‘</button>
        <div style="font-family: 'Cinzel'; font-size: 10px; color: gold;">GOLD FRAME FIXED</div>
        <div style="width: 10px;"></div>
    </div>

    <div class="overlay-editor" id="overlay">
        <div style="max-width: 450px; margin: 0 auto;">
            <div class="input-box"><label>á…áŸ†áá„á‡á¾á„</label><input type="text" id="inTitle" value="CERTIFICATE" oninput="autoSave()"></div>
            <div class="input-box"><label>áˆáŸ’á˜áŸ„áŸ‡áŸá·áŸáŸ’áŸ</label><input type="text" id="inName" placeholder="áˆáŸ’á˜áŸ„áŸ‡áŸá·áŸáŸ’áŸ..." oninput="autoSave()"></div>
            <div class="input-box"><label>ááŸ’á›á¹á˜áŸá¶áš</label><textarea id="inDesc" rows="2" oninput="autoSave()">áŸá˜áŸ’ášá¶á”áŸ‹á€á¶ášá”á‰áŸ’á…á”áŸ‹áœá‚áŸ’á‚áŸá·á€áŸ’áŸá¶ "á€á¶ášášá…á“á¶á‚áŸá á‘áŸ†á–áŸáš" áŠáŸ„á™á‡áŸ„á‚á‡áŸá™áŸ”</textarea></div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <div class="input-box"><label>á”áŸ’ášá’á¶á“ (á†áŸ’áœáŸá„)</label><input type="text" id="inMan" value="á›áŸ„á€ á áŸŠá¶á„ áŸá»á—áŸá€áŸ’ááŸ’áš" oninput="autoSave()"></div>
                <div class="input-box"><label>ááŸ’á„áŸƒááŸ‚ (áŸáŸ’áá¶áŸ†)</label><input type="text" id="inDate" value="ááŸ’á„áŸƒá‘á¸ áŸ áŸ¦ á€á»á˜áŸ’á—áŸˆ áŸ¢áŸ áŸ¢áŸ¦" oninput="autoSave()"></div>
            </div>
            <button class="btn-action" onclick="addNewCert()">+ á”á„áŸ’á€á¾áááŸ’á˜á¸</button>
            <button class="btn-action" style="background:var(--gold-color); color:#000; border:none;" onclick="downloadAll()">á‘á¶á‰á™á€ (HD PNG)</button>
            <button class="btn-action" style="background:#eee; color:#333; border:none;" onclick="toggleMenu()">á”á·á‘</button>
        </div>
    </div>

    <div class="preview-area" id="certList"></div>

    <script>
        function toggleMenu() { document.getElementById('overlay').classList.toggle('active'); }
        function closeAds() { document.getElementById('adsPopup').style.display = 'none'; }

        function autoSave() {
            const data = {
                title: document.getElementById('inTitle').value,
                name: document.getElementById('inName').value,
                desc: document.getElementById('inDesc').value,
                man: document.getElementById('inMan').value,
                date: document.getElementById('inDate').value
            };
            localStorage.setItem('cert_gold_fixed', JSON.stringify(data));
        }

        function loadData() {
            const saved = localStorage.getItem('cert_gold_fixed');
            if (saved) {
                const d = JSON.parse(saved);
                document.getElementById('inTitle').value = d.title;
                document.getElementById('inName').value = d.name;
                document.getElementById('inDesc').value = d.desc;
                document.getElementById('inMan').value = d.man;
                document.getElementById('inDate').value = d.date;
            }
        }

        function addNewCert() {
            const title = document.getElementById('inTitle').value;
            const name = document.getElementById('inName').value || "áˆáŸ’á˜áŸ„áŸ‡áŸá·áŸáŸ’áŸ";
            const desc = document.getElementById('inDesc').value;
            const man = document.getElementById('inMan').value;
            const date = document.getElementById('inDate').value;

            const html = `
                <div class="cert-wrapper">
                    <div class="cert-paper" data-name="${name}">
                        <div class="gold-frame-outer">
                            <div class="gold-frame-inner">
                                <div class="cert-content">
                                    <div style="text-align:center;">
                                        <h1 class="header-title">${title}</h1>
                                        <div class="sub-title">OF EXCELLENCE</div>
                                    </div>
                                    <div style="text-align:center;">
                                        <p style="font-size:22px; color:#666; margin:0;">áœá·á‰áŸ’á‰á¶á”á“á”áŸááŸ’ášá“áŸáŸ‡á•áŸ’áŠá›áŸ‹á‡á¼á“á…áŸ†á–áŸ„áŸ‡</p>
                                        <div class="student-name">${name}</div>
                                    </div>
                                    <div class="desc">${desc}</div>
                                    <div class="footer">
                                        <div class="sign-block">
                                            <div class="sign-name">${man}</div>
                                            <div class="line"></div>
                                            <div class="sign-label">SIGNATURE</div>
                                        </div>
                                        <div class="sign-block">
                                            <div class="sign-name">${date}</div>
                                            <div class="line"></div>
                                            <div class="sign-label">DATE</div>
                                        </div>
                                    </div>
                                    <img src="https://cdn-icons-png.flaticon.com/512/610/610333.png" class="seal">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`;
            document.getElementById('certList').insertAdjacentHTML('beforeend', html);
            if(document.getElementById('overlay').classList.contains('active')) toggleMenu();
        }

        window.onload = () => { loadData(); addNewCert(); };

        async function downloadAll() {
            const certs = document.querySelectorAll('.cert-paper');
            if (certs.length === 0) return;
            alert("á€áŸ†á–á»á„á”á„áŸ’á€á¾áášá¼á”á—á¶á– HD... áŸá¼á˜ášá„áŸ‹á…á¶áŸ†!");
            
            for (let c of certs) {
                await document.fonts.ready;
                const canvas = await html2canvas(c, { 
                    scale: 3, /* á€á˜áŸ’ášá·áá…áŸ’á”á¶áŸáŸ‹ 3x */
                    useCORS: true,
                    backgroundColor: null,
                    scrollX: 0,
                    scrollY: -window.scrollY
                });
                
                const link = document.createElement('a');
                link.download = `Certificate_${c.getAttribute('data-name')}.png`;
                link.href = canvas.toDataURL("image/png");
                link.click();
            }
        }
    </script>
</body>
</html>
